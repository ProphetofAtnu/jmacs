;; -*- lexical-binding: t; -*-

(setq test-file "/home/scaggj/git/install/llvm-project/clang-tools-extra/clangd/quality/model/forest.json")

(setq file-buffer (let ((buf (get-buffer-create "*test*")))
                    (with-current-buffer  buf
                        (insert-file-contents-literally test-file))))

(setq tfile (get-buffer "*test*"))


(with-current-buffer (get-buffer "*test*")
  (goto-char (point-min))
  (let ((quotes 0))
    (condition-case nil 
        (while t
          (if (eq (char-after) ?\")
              (cl-incf quotes))
          (forward-char)
          )
      ('error nil))
    quotes))


(with-current-buffer (get-buffer "*test*")
  (goto-char (point-min))
  (let ((quotes 0)
        (bstr (buffer-substring-no-properties (point-min) (point-max))))
    (cl-loop for s across bstr
          when (eq s ?\")
          do (cl-incf quotes))
    quotes))

(benchmark 1 
           '(with-current-buffer (get-buffer "*test*")
             (goto-char (point-min))
             (let ((quotes 0))
               (condition-case nil 
                   (while t
                     (if (eq (char-after) ?\")
                         (cl-incf quotes))
                     (forward-char)
                     )
                 ('error nil))
               quotes)))

(benchmark 1 
           '(with-current-buffer (get-buffer "*test*")
             (goto-char (point-min))
             (let ((quotes 0)
                   (bstr (buffer-substring-no-properties (point-min) (point-max))))
               (cl-loop for s across bstr
                     when (eq s ?\")
                     do (cl-incf quotes))
               quotes)))


(benchmark 1 
           '(with-current-buffer (get-buffer "*test*")
             (goto-char (point-min))
             (let ((quotes 0)
                   (pos -1)
                   (bstr (buffer-substring-no-properties (point-min) (point-max))))
               (while  (setf pos (string-search "\"" bstr (1+ pos)))
                 (cl-incf quotes))
               quotes)))

(benchmark 1 
           '(with-current-buffer (get-buffer "*test*")
             (goto-char (point-min))
             (let ((quotes 0))
               (while  (search-forward "\"" nil t)
                 (cl-incf quotes))
               quotes)))

Debugger entered--entering a function:
* message("%s" #("‘\n’: Syntax Error: expected pattern [syntax-error]..." 1 2 (fontified t) 52 53 (fontified t)))
  display-message-or-buffer(#("‘\n’: Syntax Error: expected pattern [syntax-error]..." 1 2 (fontified t) 52 53 (fontified t)) "*Flycheck error messages*" not-this-window)
  flycheck-display-error-messages((#s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/projects/forester/forester/src/state...." :line 128 :column 5 :message "Syntax Error: expected pattern" :level error :id "syntax-error" :group "rust-analyzer" :-end-line 128 :-end-column 5) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/projects/forester/forester/src/state...." :line 128 :column 5 :message "Syntax Error: expected SEMICOLON" :level error :id "syntax-error" :group "rust-analyzer" :-end-line 128 :-end-column 5)))
  flycheck-display-errors((#s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/projects/forester/forester/src/state...." :line 128 :column 5 :message "Syntax Error: expected pattern" :level error :id "syntax-error" :group "rust-analyzer" :-end-line 128 :-end-column 5) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/projects/forester/forester/src/state...." :line 128 :column 5 :message "Syntax Error: expected SEMICOLON" :level error :id "syntax-error" :group "rust-analyzer" :-end-line 128 :-end-column 5)))
  flycheck-display-error-at-point()
  flycheck-finish-current-syntax-check((#s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 128 :column 5 :message "Syntax Error: expect..." :level error :id "syntax-error" :group "rust-analyzer" :-end-line 128 :-end-column 5) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 128 :column 5 :message "Syntax Error: expect..." :level error :id "syntax-error" :group "rust-analyzer" :-end-line 128 :-end-column 5) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 126 :column 13 :message "unused variable: `by..." :level lsp-flycheck-warning-unnecessary :id "unused_variables" :group "rustc" :-end-line 126 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 126 :column 13 :message "if this is intention..." :level info :id "unused_variables" :group "rustc" :-end-line 126 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 127 :column 10 :message "unused variable: `in..." :level lsp-flycheck-warning-unnecessary :id "unused_variables" :group "rustc" :-end-line 127 :-end-column 14) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 127 :column 10 :message "if this is intention..." :level info :id "unused_variables" :group "rustc" :-end-line 127 :-end-column 14) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 127 :column 6 :message "variable does not ne..." :level warning :id "unused_mut" :group "rustc" :-end-line 127 :-end-column 14) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 127 :column 6 :message "remove this `mut`" :level info :id "unused_mut" :group "rustc" :-end-line 127 :-end-column 10) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 3 :column 10 :message "enum `IniEvent` is n..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 3 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 12 :column 8 :message "method `add` is neve..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 12 :-end-column 11) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 10 :column 1 :message "method in this imple..." :level info :id "dead_code" :group "rustc" :-end-line 10 :-end-column 14) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 22 :column 10 :message "enum `IniError` is n..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 22 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 27 :column 12 :message "struct `LightIniPars..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 27 :-end-column 26) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 34 :column 12 :message "associated items `ne..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 34 :-end-column 15) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 33 :column 1 :message "associated items in ..." :level info :id "dead_code" :group "rustc" :-end-line 33 :-end-column 20) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 42 :column 12 :message "associated items `ne..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 42 :-end-column 16) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 4 :column 5 :message "variants `Top`, `Key..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 4 :-end-column 8) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 3 :column 10 :message "variants in this enu..." :level info :id "dead_code" :group "rustc" :-end-line 3 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 5 :column 5 :message "variants `Top`, `Key..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 5 :-end-column 8) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 6 :column 5 :message "variants `Top`, `Key..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 6 :-end-column 12) ...) "/home/scaggj/project...")
  flycheck-report-buffer-checker-status(#s(flycheck-syntax-check :buffer #<buffer state.rs> :checker lsp :context nil :working-directory "/home/scaggj/project...") finished (#s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 128 :column 5 :message "Syntax Error: expect..." :level error :id "syntax-error" :group "rust-analyzer" :-end-line 128 :-end-column 5) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 128 :column 5 :message "Syntax Error: expect..." :level error :id "syntax-error" :group "rust-analyzer" :-end-line 128 :-end-column 5) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 126 :column 13 :message "unused variable: `by..." :level lsp-flycheck-warning-unnecessary :id "unused_variables" :group "rustc" :-end-line 126 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 126 :column 13 :message "if this is intention..." :level info :id "unused_variables" :group "rustc" :-end-line 126 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 127 :column 10 :message "unused variable: `in..." :level lsp-flycheck-warning-unnecessary :id "unused_variables" :group "rustc" :-end-line 127 :-end-column 14) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 127 :column 10 :message "if this is intention..." :level info :id "unused_variables" :group "rustc" :-end-line 127 :-end-column 14) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 127 :column 6 :message "variable does not ne..." :level warning :id "unused_mut" :group "rustc" :-end-line 127 :-end-column 14) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 127 :column 6 :message "remove this `mut`" :level info :id "unused_mut" :group "rustc" :-end-line 127 :-end-column 10) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 3 :column 10 :message "enum `IniEvent` is n..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 3 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 12 :column 8 :message "method `add` is neve..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 12 :-end-column 11) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 10 :column 1 :message "method in this imple..." :level info :id "dead_code" :group "rustc" :-end-line 10 :-end-column 14) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 22 :column 10 :message "enum `IniError` is n..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 22 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 27 :column 12 :message "struct `LightIniPars..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 27 :-end-column 26) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 34 :column 12 :message "associated items `ne..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 34 :-end-column 15) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 33 :column 1 :message "associated items in ..." :level info :id "dead_code" :group "rustc" :-end-line 33 :-end-column 20) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 42 :column 12 :message "associated items `ne..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 42 :-end-column 16) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 4 :column 5 :message "variants `Top`, `Key..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 4 :-end-column 8) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 3 :column 10 :message "variants in this enu..." :level info :id "dead_code" :group "rustc" :-end-line 3 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 5 :column 5 :message "variants `Top`, `Key..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 5 :-end-column 8) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 6 :column 5 :message "variants `Top`, `Key..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 6 :-end-column 12) ...))
  apply(flycheck-report-buffer-checker-status #s(flycheck-syntax-check :buffer #<buffer state.rs> :checker lsp :context nil :working-directory "/home/scaggj/project...") (finished (... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ...)))
  #f(compiled-function (&rest args) #<bytecode -0x32d71396e0349ed>)(finished (#s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 128 :column 5 :message "Syntax Error: expect..." :level error :id "syntax-error" :group "rust-analyzer" :-end-line 128 :-end-column 5) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 128 :column 5 :message "Syntax Error: expect..." :level error :id "syntax-error" :group "rust-analyzer" :-end-line 128 :-end-column 5) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 126 :column 13 :message "unused variable: `by..." :level lsp-flycheck-warning-unnecessary :id "unused_variables" :group "rustc" :-end-line 126 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 126 :column 13 :message "if this is intention..." :level info :id "unused_variables" :group "rustc" :-end-line 126 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 127 :column 10 :message "unused variable: `in..." :level lsp-flycheck-warning-unnecessary :id "unused_variables" :group "rustc" :-end-line 127 :-end-column 14) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 127 :column 10 :message "if this is intention..." :level info :id "unused_variables" :group "rustc" :-end-line 127 :-end-column 14) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 127 :column 6 :message "variable does not ne..." :level warning :id "unused_mut" :group "rustc" :-end-line 127 :-end-column 14) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 127 :column 6 :message "remove this `mut`" :level info :id "unused_mut" :group "rustc" :-end-line 127 :-end-column 10) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 3 :column 10 :message "enum `IniEvent` is n..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 3 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 12 :column 8 :message "method `add` is neve..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 12 :-end-column 11) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 10 :column 1 :message "method in this imple..." :level info :id "dead_code" :group "rustc" :-end-line 10 :-end-column 14) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 22 :column 10 :message "enum `IniError` is n..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 22 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 27 :column 12 :message "struct `LightIniPars..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 27 :-end-column 26) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 34 :column 12 :message "associated items `ne..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 34 :-end-column 15) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 33 :column 1 :message "associated items in ..." :level info :id "dead_code" :group "rustc" :-end-line 33 :-end-column 20) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 42 :column 12 :message "associated items `ne..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 42 :-end-column 16) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 4 :column 5 :message "variants `Top`, `Key..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 4 :-end-column 8) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 3 :column 10 :message "variants in this enu..." :level info :id "dead_code" :group "rustc" :-end-line 3 :-end-column 18) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 5 :column 5 :message "variants `Top`, `Key..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 5 :-end-column 8) #s(flycheck-error :buffer #<buffer state.rs> :checker lsp :filename "/home/scaggj/project..." :line 6 :column 5 :message "variants `Top`, `Key..." :level lsp-flycheck-warning-unnecessary :id "dead_code" :group "rustc" :-end-line 6 :-end-column 12) ...))
  lsp-diagnostics--flycheck-start(lsp #f(compiled-function (&rest args) #<bytecode -0x32d71396e0349ed>))
  flycheck-syntax-check-start(#s(flycheck-syntax-check :buffer #<buffer state.rs> :checker lsp :context nil :working-directory "/home/scaggj/projects/forester/forester/src/") #f(compiled-function (&rest args) #<bytecode -0x32d71396e0349ed>))
  flycheck-start-current-syntax-check(lsp)
  flycheck-buffer()
  flycheck-buffer-automatically((idle-change))
  flycheck--handle-idle-trigger(#<buffer state.rs>)
  apply(flycheck--handle-idle-trigger #<buffer state.rs>)
  timer-event-handler([t 25685 4055 705426 nil flycheck--handle-idle-trigger (#<buffer state.rs>) nil 805000 nil])